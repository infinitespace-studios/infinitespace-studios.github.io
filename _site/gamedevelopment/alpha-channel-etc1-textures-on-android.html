<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Alpha Channel ETC1 Textures on Xamarin.Android | Infinitespace Studios</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Alpha Channel ETC1 Textures on Xamarin.Android" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So …. supporting compressed textures on android is a right pain. There are a number of different graphics chips in play and they all support different texture compression formats, not very helpful. The only common format that is supported by all devices is the ETC1 format (ETC2 is GLES 3.0 only), the problem with this format is it doesn’t support an alpha channel. Most game developers out there will know that the alpha channel is kinda important for games. So how can we make use of ETC1 and get a alpha channel at the same time?" />
<meta property="og:description" content="So …. supporting compressed textures on android is a right pain. There are a number of different graphics chips in play and they all support different texture compression formats, not very helpful. The only common format that is supported by all devices is the ETC1 format (ETC2 is GLES 3.0 only), the problem with this format is it doesn’t support an alpha channel. Most game developers out there will know that the alpha channel is kinda important for games. So how can we make use of ETC1 and get a alpha channel at the same time?" />
<link rel="canonical" href="http://localhost:4000/gamedevelopment/alpha-channel-etc1-textures-on-android" />
<meta property="og:url" content="http://localhost:4000/gamedevelopment/alpha-channel-etc1-textures-on-android" />
<meta property="og:site_name" content="Infinitespace Studios" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-05-19T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Alpha Channel ETC1 Textures on Xamarin.Android" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2014-05-19T00:00:00+01:00","datePublished":"2014-05-19T00:00:00+01:00","description":"So …. supporting compressed textures on android is a right pain. There are a number of different graphics chips in play and they all support different texture compression formats, not very helpful. The only common format that is supported by all devices is the ETC1 format (ETC2 is GLES 3.0 only), the problem with this format is it doesn’t support an alpha channel. Most game developers out there will know that the alpha channel is kinda important for games. So how can we make use of ETC1 and get a alpha channel at the same time?","headline":"Alpha Channel ETC1 Textures on Xamarin.Android","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/gamedevelopment/alpha-channel-etc1-textures-on-android"},"url":"http://localhost:4000/gamedevelopment/alpha-channel-etc1-textures-on-android"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom head content - add custom meta tags, analytics, etc. here -->

  </head>
  <body>
    <header class="site-header">
      <div class="header-content">
        <a href="/" class="logo-link">
          <img src="/images/issheader.png" alt="Infinitespace Studios" class="site-logo">
          <span class="site-title">Infinitespace Studios</span>
        </a>
        <nav class="main-nav">
          <ul>
            <li><a href="/">Blog</a></li>
            <li><a href="/games">Games</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/monogame-ports">Ports</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="site-content">
      <div class="container-with-sidebar">
        <div class="main-content">
          <p>So …. supporting compressed textures on android is a right pain. There are a number of different graphics chips in play and they all support different texture compression formats, not very helpful. The only common format that is supported by all devices is the ETC1 format (ETC2 is GLES 3.0 only), the problem with this format is it doesn’t support an alpha channel. Most game developers out there will know that the alpha channel is kinda important for games. So how can we make use of ETC1 and get a alpha channel at the same time?</p>

<p>There are a number of different methods that I’ve found on the net mostly have to do with storing the alpha channel separately and combining them in the fragment shader, <a href="http://malideveloper.arm.com/develop-for-mali/sample-code/etcv1-texture-compression-and-alpha-channels/">this</a> article seems to contain the most accepted solutions. But personally I hate the idea of having to have two textures or mess about with texture coordinates to sample the data from different parts. If only there was another way… well lets turn back the clock a bit an use a technique we used to use before such a thing as an alpha channel even existed.</p>

<p>I’m talking about using a ColorKey, this is where you define a single colour in your image as the transparent colour, its used allot in movies these days for green screen work. We used to use this technique allot back in the day when video hardware didn’t event know what an alpha channel was, so you just skip over the bits of the image that match the colour key and hey presto , you get a transparent image :).</p>

<p>So lets take a look at this image.</p>

<p><img src="../images/f_spot-150x150.png" alt="f_spot" /></p>

<p>it has a nice alpha channel. But if we replace the alpha with a constant colour like so</p>

<p><img src="../images/f_spot_rgb-150x150.png" alt="f_spot_rgb" /></p>

<p>we can then re-write our fragment shader to just detect this colour and set the alpha channel explicitly without having to mess about with other bitmaps, or changing texture coordinates. So our fragment shader simply becomes</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">uniform</span> <span class="kt">lowp</span> <span class="kt">sampler2D</span> <span class="n">u_Texture</span><span class="p">;</span>
<span class="k">varying</span> <span class="kt">mediump</span> <span class="kt">vec2</span> <span class="n">v_TexCoordinate</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">vec4</span> <span class="n">colorkey</span> <span class="o">=</span> <span class="kt">vec4</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">96470588</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
  <span class="kt">float</span> <span class="n">cutoff</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">;</span>
  <span class="kt">vec4</span> <span class="n">colour</span> <span class="o">=</span> <span class="n">texture2D</span><span class="p">(</span><span class="n">u_Texture</span><span class="p">,</span> <span class="n">v_TexCoordinate</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">abs</span><span class="p">(</span><span class="n">colour</span><span class="p">.</span><span class="n">r</span> <span class="o">-</span> <span class="n">colorkey</span><span class="p">.</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">colour</span><span class="p">.</span><span class="n">g</span> <span class="o">-</span> <span class="n">colorkey</span><span class="p">.</span><span class="n">g</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">colour</span><span class="p">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">colorkey</span><span class="p">.</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">))</span> <span class="p">{</span>
       <span class="n">colour</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nb">gl_FragColor</span> <span class="o">=</span> <span class="n">colour</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>In this case I hardcoded the colour I’m using for the ColorKey but this could easily be passed in as a uniform if you wanted the flexibility of being able to change it.</p>

<p>With this in place we can now use ETC1 textures across all android devices and get a alpha channel. While its not a full alpha channel (with semi transparency) it will probably be enough for most games. You can generate your compressed textures using the ‘etc1util’ tool provided with the android sdk. Its located in the tools folder of the sdk and you can just call</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>etc1tool  _infile_ <span class="nt">-encode</span> <span class="nt">-o</span> _outfile_
</code></pre></div></div>

<p>you can then include the resulting <em>outfile</em> in your Assets folder and set its build action to ‘AndroidAsset’ then use the following code to load the texture</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">int</span> <span class="nf">LoadTextureFromAssets</span> <span class="p">(</span><span class="n">Activity</span> <span class="n">activity</span><span class="p">,</span> <span class="kt">string</span> <span class="n">filename</span><span class="p">)</span>
<span class="p">{</span>

  <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">s</span> <span class="p">=</span> <span class="n">activity</span><span class="p">.</span><span class="n">Assets</span><span class="p">.</span><span class="nf">Open</span> <span class="p">(</span><span class="n">filename</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">t</span> <span class="p">=</span> <span class="n">Android</span><span class="p">.</span><span class="n">Opengl</span><span class="p">.</span><span class="n">ETC1Util</span><span class="p">.</span><span class="nf">CreateTexture</span> <span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">tid</span> <span class="p">=</span> <span class="n">GL</span><span class="p">.</span><span class="nf">GenTexture</span> <span class="p">();</span>
      <span class="n">GL</span><span class="p">.</span><span class="nf">ActiveTexture</span> <span class="p">(</span><span class="n">All</span><span class="p">.</span><span class="n">Texture0</span><span class="p">);</span>
      <span class="n">GL</span><span class="p">.</span><span class="nf">BindTexture</span> <span class="p">(</span><span class="n">All</span><span class="p">.</span><span class="n">Texture2D</span><span class="p">,</span> <span class="n">tid</span><span class="p">);</span>
      <span class="c1">// setup texture parameters</span>
      <span class="n">GL</span><span class="p">.</span><span class="nf">TexParameter</span> <span class="p">(</span><span class="n">All</span><span class="p">.</span><span class="n">Texture2D</span><span class="p">,</span> <span class="n">All</span><span class="p">.</span><span class="n">TextureMagFilter</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">Linear</span><span class="p">);</span>
      <span class="n">GL</span><span class="p">.</span><span class="nf">TexParameter</span> <span class="p">(</span><span class="n">All</span><span class="p">.</span><span class="n">Texture2D</span><span class="p">,</span> <span class="n">All</span><span class="p">.</span><span class="n">TextureMinFilter</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">Nearest</span><span class="p">);</span>
      <span class="n">GL</span><span class="p">.</span><span class="nf">TexParameter</span> <span class="p">(</span><span class="n">All</span><span class="p">.</span><span class="n">Texture2D</span><span class="p">,</span> <span class="n">All</span><span class="p">.</span><span class="n">TextureWrapS</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">ClampToEdge</span><span class="p">);</span>
      <span class="n">GL</span><span class="p">.</span><span class="nf">TexParameter</span> <span class="p">(</span><span class="n">All</span><span class="p">.</span><span class="n">Texture2D</span><span class="p">,</span> <span class="n">All</span><span class="p">.</span><span class="n">TextureWrapT</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">ClampToEdge</span><span class="p">);</span>
      <span class="n">Android</span><span class="p">.</span><span class="n">Opengl</span><span class="p">.</span><span class="n">ETC1Util</span><span class="p">.</span><span class="nf">LoadTexture</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">Texture2D</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">Rgb</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">All</span><span class="p">.</span><span class="n">UnsignedShort565</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">tid</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note you’ll need to add using clauses for the various OpenTK namespaces used in the code.</p>

<p>Now there is a problem with this technique, because of the way ETC1 works you will more than likely get some compression artefacts on the resulting image. In this my case I ended up with a purple/pink line around the image I was rendering. So perhaps that colour isn’t the best choice in this case.</p>

<p><img src="../images/Screenshot_2014-05-19-09-55-01-180x300.png" alt="Screenshot_2014-05-19-09-55-01" /></p>

<p>So I tried again this time with a black colour key. This might help reduce the compression artifacts around the edges of the image. But I had to make some changes to the shader to make it a bit more generic and to handle a black colour key. The resulting shader turned out to be as follows.</p>

<div class="language-glsl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">uniform</span> <span class="kt">lowp</span> <span class="kt">sampler2D</span> <span class="n">u_Texture</span><span class="p">;</span>
<span class="k">varying</span> <span class="kt">mediump</span> <span class="kt">vec2</span> <span class="n">v_TexCoordinate</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">float</span> <span class="n">cutoff</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">28</span><span class="p">;</span>
  <span class="kt">vec4</span> <span class="n">colour</span> <span class="o">=</span> <span class="n">texture2D</span><span class="p">(</span><span class="n">u_Texture</span><span class="p">,</span> <span class="n">v_TexCoordinate</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">colour</span><span class="p">.</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="n">colour</span><span class="p">.</span><span class="n">g</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="p">(</span><span class="n">colour</span><span class="p">.</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">))</span> <span class="p">{</span>
       <span class="n">colour</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">colour</span><span class="p">.</span><span class="n">r</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nb">gl_FragColor</span> <span class="o">=</span> <span class="n">colour</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>You can see we are just using a rgb cutoff value to detect the black in the image and turn that into a transparency. Note that I’m using the red channel to set the transparent colour rather than just using 0.0, hopefully this will help with the blending. This produced the following result.</p>

<p><img src="../images/Screenshot_2014-05-19-09-56-31-180x300.png" alt="Screenshot_2014-05-19-09-56-31" /></p>

<p>There is a slight black edge around the image, but it is probably be something you can get away with. The only issue with this is you can’t use black in your image :( or if you do it has to be above the colour cutoff in the shader, that will require some testing to see what values you can get away with.</p>

<p>Well hopefully this will be useful for someone. Next time around I’ll be going into how to support texture compression formats like PVRTC, ATITC and S3TC on your android devices. These formats should cover most of the devices out there (but not all) and support a full alpha channel, but if you are after full compatibility then ETC1 is probably the way to go.</p>

<p>In the mean time the code from this article is available on <a href="https://github.com/infinitespace-studios/Blog/tree/master/Etc1Alpha">github</a>.</p>

        </div>
        <aside class="games-sidebar">
  <h3>My Games</h3>
  <div class="game-widgets">
    <iframe frameborder="0" src="https://itch.io/embed/4195013?border_width=0&amp;bg_color=000000&amp;fg_color=ffffff&amp;link_color=5becfa" width="206" height="165"><a href="https://infinitespace-studios.itch.io/co-operoids">Co-operoids by infinitespace-studios</a></iframe>
  </div>
  <div class="game-widgets">
    <iframe frameborder="0" src="https://itch.io/embed/120692?border_width=0&amp;bg_color=000000&amp;link_color=5bfa8b&amp;border_color=000000" width="206" height="165"><a href="https://infinitespace-studios.itch.io/vector-rumble">Vector Rumble by infinitespace-studios</a></iframe>
  </div>
</aside>

      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>&copy; 2009-2026 Infinitespace Studios. All rights reserved.</p>
        <div class="social-links">
          <a href="https://github.com/infinitespace-studios" aria-label="GitHub">GitHub</a>
          <a href="https://bsky.app/profile/infspacestudios.bsky.social" aria-label="Bluesky">Bluesky</a>
          <a href="https://mastodon.gamedev.place/@infspacestudios" aria-label="Mastodon">Mastodon</a>
        </div>
      </div>
    </footer>
  </body>
</html>