<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Handling multiple screen resolutions in MonoGame for Android – Part 2 | Infinitespace Studios</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Handling multiple screen resolutions in MonoGame for Android – Part 2" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In my previous post we looked at how to modify the ScreenManager class to support multiple resolutions. This works fine but what we also need is a way to scale the inputs from the Mouse or TouchScreen so that they operate at the same virtual resolution as the game does." />
<meta property="og:description" content="In my previous post we looked at how to modify the ScreenManager class to support multiple resolutions. This works fine but what we also need is a way to scale the inputs from the Mouse or TouchScreen so that they operate at the same virtual resolution as the game does." />
<link rel="canonical" href="http://localhost:4000/general/handling-multiple-screen-resolutions-in-monogame-for-android-part-2/" />
<meta property="og:url" content="http://localhost:4000/general/handling-multiple-screen-resolutions-in-monogame-for-android-part-2/" />
<meta property="og:site_name" content="Infinitespace Studios" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-05-23T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Handling multiple screen resolutions in MonoGame for Android – Part 2" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2014-05-23T00:00:00+01:00","datePublished":"2014-05-23T00:00:00+01:00","description":"In my previous post we looked at how to modify the ScreenManager class to support multiple resolutions. This works fine but what we also need is a way to scale the inputs from the Mouse or TouchScreen so that they operate at the same virtual resolution as the game does.","headline":"Handling multiple screen resolutions in MonoGame for Android – Part 2","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/general/handling-multiple-screen-resolutions-in-monogame-for-android-part-2/"},"url":"http://localhost:4000/general/handling-multiple-screen-resolutions-in-monogame-for-android-part-2/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom head content - add custom meta tags, analytics, etc. here -->

  </head>
  <body>
    <header class="site-header">
      <div class="header-content">
        <a href="/" class="logo-link">
          <img src="/images/issheader.png" alt="Infinitespace Studios" class="site-logo">
          <span class="site-title">Infinitespace Studios</span>
        </a>
        <nav class="main-nav">
          <ul>
            <li><a href="/">Blog</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/monogame-ports">Ports</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="site-content">
      <div class="container">
        <p>In my previous <a href="http://infinitespace-studios.co.uk/general/handling-multiple-screen-resolutions-in-monogame-for-android-part-1">post</a> we looked at how to modify the <a href="http://create.msdn.com/en-US/education/catalog/sample/game_state_management">ScreenManager</a> class to support multiple resolutions. This works fine but what we also need is a way to scale the inputs from the Mouse or TouchScreen so that they operate at the same virtual resolution as the game does.</p>

<p>We already put in place the following properties in the ScreenManager</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">property</span> <span class="n">Matrix</span> <span class="n">InputScale</span> <span class="err">…</span><span class="p">..</span>
<span class="n">property</span> <span class="n">Vector2</span> <span class="n">InputTranslate</span><span class="err"> </span> <span class="err">…</span><span class="p">..</span>
</code></pre></div></div>

<p>InputScale is the Inverse of the Scale matrix which will allow use to scale the input from the mouse into the virtual resolution. InputTranslate needs to be used because we sometimes put a letterbox around the gameplay area to center it and the input system needs to take this into account (otherwise you end up clicking above menu items rather than on them).</p>

<p>So we need to update the InputState.cs class which comes as part of the <a href="http://create.msdn.com/en-US/education/catalog/sample/game_state_management">Game State Management</a> example. First thing we need to do is to add a property to the InputState class for the  ScreenManager.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="n">ScreenManager</span> <span class="n">ScreenManager</span>
<span class="p">{</span>
  <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>and then update the ScreenManager constructor to set the property.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">input</span><span class="p">.</span><span class="n">ScreenManager</span><span class="p">=</span><span class="k">this</span><span class="p">;</span>
</code></pre></div></div>

<p>Now we need to update the InputState.Update method. Find the following line</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CurrentMouseState</span> <span class="p">=</span> <span class="n">Mouse</span><span class="p">.</span><span class="nf">GetState</span><span class="p">();</span>
</code></pre></div></div>

<p>We now need to translate and scale the CurrentMouseState field into the correct virtual resolution. We can do that my accessing the ScreenManager property which we just added, so add the following code.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Vector2</span> <span class="n">_mousePosition</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">Y</span><span class="p">);</span>
<span class="n">Vector2</span> <span class="n">p</span> <span class="p">=</span> <span class="n">_mousePosition</span> <span class="p">-</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputTranslate</span><span class="p">;</span>
<span class="n">p</span> <span class="p">=</span><span class="err"> </span><span class="n">Vector2</span><span class="p">.</span><span class="nf">Transform</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputScale</span><span class="p">);</span>
<span class="n">CurrentMouseState</span> <span class="p">=</span><span class="k">new</span> <span class="nf">MouseState</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">p</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">p</span><span class="p">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">ScrollWheelValue</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">MiddleButton</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">RightButton</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">XButton1</span><span class="p">,</span> <span class="n">CurrentMouseState</span><span class="p">.</span><span class="n">XButton2</span><span class="p">);</span>
</code></pre></div></div>

<p>This bit of code transforms the current mouse position and then scales it before creating a new MouseState instance with the new position values, but the same values for everything else. If the ScrollWheelValue is being used that might need scaling too.</p>

<p>Next stop is to scale the gestures, in the same Update method there should be the following code</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Gestures</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(</span><span class="n">TouchPanel</span><span class="p">.</span><span class="n">IsGestureAvailable</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">Gestures</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">TouchPanel</span><span class="p">.</span><span class="nf">ReadGesture</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We need to change this code over to</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Gestures</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(</span><span class="n">TouchPanel</span><span class="p">.</span><span class="n">IsGestureAvailable</span><span class="p">)</span> <span class="p">{</span>
<span class="n">GestureSample</span> <span class="n">g</span> <span class="p">=</span> <span class="n">TouchPanel</span><span class="p">.</span><span class="nf">ReadGesture</span><span class="p">();</span>
<span class="n">Vector2</span> <span class="n">p1</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="nf">Transform</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">Position</span><span class="p">-</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputTranslate</span><span class="p">,</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputScale</span><span class="p">);</span>
<span class="n">Vector2</span> <span class="n">p2</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="nf">Transform</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">Position2</span><span class="p">-</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputTranslate</span><span class="p">,</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputScale</span><span class="p">);</span>
<span class="n">Vector2</span> <span class="n">p3</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="nf">Transform</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">Delta</span><span class="p">-</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputTranslate</span><span class="p">,</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputScale</span><span class="p">);</span>
<span class="n">Vector2</span> <span class="n">p4</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="nf">Transform</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">Delta2</span><span class="p">-</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputTranslate</span><span class="p">,</span> <span class="n">ScreenManager</span><span class="p">.</span><span class="n">InputScale</span><span class="p">);</span>
<span class="n">g</span> <span class="p">=</span><span class="k">new</span> <span class="nf">GestureSample</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">GestureType</span><span class="p">,</span> <span class="n">g</span><span class="p">.</span><span class="n">Timestamp</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">);</span>
<span class="n">Gestures</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We use similar code to translate and scale each position and delta value from the GestureSample, then again create a new GestureSample with the new values.</p>

<p>That should be all you need to do. This will now scale both mouse and gesture inputs into the virtual resolution.</p>

<p>As before the complete code can be downloaded <a href="http://www.infinitespace-studios.co.uk/code/InputState.cs">http://www.infinitespace-studios.co.uk/code/InputState.cs</a>, or you can download the both files <a href="http://www.infinitespace-studios.co.uk/code/InputState.cs">InputState.cs</a> <a href="http://www.infinitespace-studios.co.uk/code/ScreenManager.cs">ScreenManager.cs</a></p>

<p>Update : The MouseGestureType is the InputState is from the CatapultWars sample and can be downloaded <a href="http://www.infinitespace-studios.co.uk/code/MouseGestureType.cs">http://www.infinitespace-studios.co.uk/code/MouseGestureType.cs</a></p>

      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>&copy; 2009-2026 Infinitespace Studios. All rights reserved.</p>
        <div class="social-links">
          <a href="https://github.com/dellis1972" aria-label="GitHub">GitHub</a>
          <a href="https://mastodon.gamedev.place/@infspacestudios" aria-label="Mastodon">Mastodon</a>
        </div>
      </div>
    </footer>
  </body>
</html>