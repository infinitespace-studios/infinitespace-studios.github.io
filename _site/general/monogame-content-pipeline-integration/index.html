<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>MonoGame - Content Pipeline integration | Infinitespace Studios</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="MonoGame - Content Pipeline integration" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the past it might seem that Windows users of MonoGame get all the cool stuff, and Mac / Linux users are left out in the cold. To be honest for a while that was true, but the great news is that more recently that has begun to change. On going community efforts have resulted in both MacOS and Linux installers which will download and install templates into the Xamarin Studio and MonoDevelop. They also install the Pipeline tool which is a GUI you can use to build your content for your game." />
<meta property="og:description" content="In the past it might seem that Windows users of MonoGame get all the cool stuff, and Mac / Linux users are left out in the cold. To be honest for a while that was true, but the great news is that more recently that has begun to change. On going community efforts have resulted in both MacOS and Linux installers which will download and install templates into the Xamarin Studio and MonoDevelop. They also install the Pipeline tool which is a GUI you can use to build your content for your game." />
<link rel="canonical" href="http://localhost:4000/general/monogame-content-pipeline-integration/" />
<meta property="og:url" content="http://localhost:4000/general/monogame-content-pipeline-integration/" />
<meta property="og:site_name" content="Infinitespace Studios" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-01-13T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MonoGame - Content Pipeline integration" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2016-01-13T00:00:00+00:00","datePublished":"2016-01-13T00:00:00+00:00","description":"In the past it might seem that Windows users of MonoGame get all the cool stuff, and Mac / Linux users are left out in the cold. To be honest for a while that was true, but the great news is that more recently that has begun to change. On going community efforts have resulted in both MacOS and Linux installers which will download and install templates into the Xamarin Studio and MonoDevelop. They also install the Pipeline tool which is a GUI you can use to build your content for your game.","headline":"MonoGame - Content Pipeline integration","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/general/monogame-content-pipeline-integration/"},"url":"http://localhost:4000/general/monogame-content-pipeline-integration/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom head content - add custom meta tags, analytics, etc. here -->

  </head>
  <body>
    <header class="site-header">
      <div class="header-content">
        <a href="/" class="logo-link">
          <img src="/images/issheader.png" alt="Infinitespace Studios" class="site-logo">
          <span class="site-title">Infinitespace Studios</span>
        </a>
        <nav class="main-nav">
          <ul>
            <li><a href="/">Blog</a></li>
            <li><a href="/games">Games</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/monogame-ports">Ports</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="site-content">
      <div class="container-with-sidebar">
        <div class="main-content">
          <p>In the past it might seem that Windows users of MonoGame get all the cool stuff, and Mac / Linux users are left out in the cold. To be honest for a while that was true, but the great news is that more recently that has begun to change. On going community efforts have resulted in both MacOS and Linux installers which will download and install templates into the Xamarin Studio and MonoDevelop. They also install the Pipeline tool which is a GUI you can use to build your content for your game.</p>

<p>All that was great, but again Windows has something that Mac and Linux developers just didn’t have access to. Automatic Content Building, this is where you just include the .mgcb file in your project, set its Build Action to “MonoGameContentReference” and providing you created the project via one of the templates it would “just work”. Your .xnb files would appear as if by magic in your Output Directory without all that messy manual linking of .xnbs.</p>

<p>So how does it work.. Well to fully understand we need to dig into MSBuild a bit :) I know recently I’ve been talking about MSBuild allot but thats because in my day job (@Xamarin) I’m dealing with it ALLOT! So its topical from my point of view ;)</p>

<p>So if you dig into your csproj which was created in Visual Studio via one of the MonoGame templates  you will see a number of things. The first is a **<MonoGamePlatform>** element. This element is used later to tell the MGCB (**M**ono**G**ame **C**ontent **B**uilder) which platform it needs to build for.  Next up is the **<MonoGameContentReference>** element which will contain a link to the .mgcb file.. This again is used later to tell MGCB which files to build. Note that you are not just limited to one of these. If you have multiple assets and different resolutions (e.g @2x stuff for iOS) you can have a separate .mgcb file for those and include that in your project. The system will collect ALL the outputs (just make sure they build into different intermediate directories).</MonoGameContentReference></MonoGamePlatform></p>

<p>The last piece of this system is the “MonoGame.Content.Builder.targets” file. This is the core of the system and you should be able to see the Import near the bottom of your .csproj. This .targets file is responsible for going through ALL the <em>MonoGameContentReference</em> Items in the csproj and calling MGCB.exe for each of them to build the content, it will also pass</p>

<blockquote>
  <p>/platform:$(MonoGamePlatform)</p>
</blockquote>

<p>to the .exe to that it will build the assets for the correct platform. This is all done in the BeforeBuild msbuild event, so it will happen before the code is even built, just like the old XNA content references used to do. But this time you don’t need to do any fiddling to get this to work on a command line, it will just work. Now calling an .exe on a build in a .targets isn’t exactly magic, the magic bit is right here</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">&lt;Target Name="BuildContent" DependsOnTargets="Prepare;RunContentBuilder" Outputs="%(ExtraContent.RecursiveDir)%(ExtraContent.Filename)%(ExtraContent.Extension)"&gt; &lt;CreateItem Include="$(ParentOutputDir)\%(ExtraContent.RecursiveDir)%(ExtraContent.Filename)%(ExtraContent.Extension)" AdditionalMetadata="Link=$(PlatformResourcePrefix)$(ContentRootDirectory)\%(ExtraContent.RecursiveDir)%(ExtraContent.Filename)%(ExtraContent.Extension);CopyToOutputDirectory=PreserveNewest" Condition="'%(ExtraContent.Filename)' != ''"&gt; &lt;Output TaskParameter="Include" ItemName="Content" Condition="'$(MonoGamePlatform)' != 'Android' And '$(MonoGamePlatform)' != 'iOS' And '$(MonoGamePlatform)' != 'MacOSX'" /&gt; &lt;Output TaskParameter="Include" ItemName="BundleResource" Condition="'$(MonoGamePlatform)' == 'MacOSX' Or '$(MonoGamePlatform)' == 'iOS'" /&gt; &lt;Output TaskParameter="Include" ItemName="AndroidAsset" Condition="'$(MonoGamePlatform)' == 'Android'" /&gt; &lt;/CreateItem&gt; &lt;/Target&gt;</code></p>
</blockquote>

<p>This part is responsible for adding the resulting .xnb files to the appropriate ItemGroup for the platform that we are targeting. So in the case of a Desktop build like Windows, Linix we use Content. For iOS and Mac we use BundleResource and for Android we use AndroidAsset. Because we are doing this just before the Build process, when those target platforms actually build the content later they will pick up the items we added in addition to any other items that the projects themselves included.</p>

<p>Now the really interesting bit is that code above was not how it originally looked.. The problem with the old code was it didn’t work with xbuild, which is what is used on Mac and Linux. So it just wouldn’t work. But now the entire .targets file will run quite happily on Mac and Linux and have intact been included in the latest unstable installers. So if you want to try it out go and download the latest development installers and give it a go.</p>

<p>If you have an existing project and you want to upgrade to use the new content pipeline system you will need to do the following</p>

<ol>
  <li>Open your Application .csproj in an Editor.</li>
  <li>In the first _<PropertyGroup>_ section add `<MonoGamePlatform>$(Platform)</MonoGamePlatform>` where $(platform) is the system you are targeting e.g Windows, iOS, Android.</PropertyGroup></li>
  <li>Add the following lines right underneath the <MonoGamePlatform></MonoGamePlatform> element <code class="language-plaintext highlighter-rouge">&lt;MonoGameInstallDirectory Condition="'$(OS)' != 'Unix' "&gt;$(MSBuildProgramFiles32)&lt;/MonoGameInstallDirectory&gt; &lt;MonoGameInstallDirectory Condition="'$(OS)' == 'Unix' "&gt;$(MSBuildExtensionsPath)&lt;/MonoGameInstallDirectory&gt;</code></li>
  <li>Find the <Import></Import> element for the CSharp (or FSharp) targets and underneath add <code class="language-plaintext highlighter-rouge">&lt;Import Project="$(MSBuildExtensionsPath)\MonoGame\v3.0\MonoGame.Content.Builder.targets" /&gt;</code></li>
</ol>

<p>Now providing you have the latest development release this should all work. So if you have an old project go ahead and give it a try, its well worth it :)</p>

        </div>
        <aside class="games-sidebar">
  <h3>My Games</h3>
  <div class="game-widgets">
    <iframe frameborder="0" src="https://itch.io/embed/4195013?border_width=0&amp;bg_color=000000&amp;fg_color=ffffff&amp;link_color=5becfa" width="206" height="165"><a href="https://infinitespace-studios.itch.io/co-operoids">Co-operoids by infinitespace-studios</a></iframe>
  </div>
  <div class="game-widgets">
    <iframe frameborder="0" src="https://itch.io/embed/120692?border_width=0&amp;bg_color=000000&amp;link_color=5bfa8b&amp;border_color=000000" width="206" height="165"><a href="https://infinitespace-studios.itch.io/vector-rumble">Vector Rumble by infinitespace-studios</a></iframe>
  </div>
</aside>

      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>&copy; 2009-2026 Infinitespace Studios. All rights reserved.</p>
        <div class="social-links">
          <a href="https://github.com/dellis1972" aria-label="GitHub">GitHub</a>
          <a href="https://mastodon.gamedev.place/@infspacestudios" aria-label="Mastodon">Mastodon</a>
        </div>
      </div>
    </footer>
  </body>
</html>