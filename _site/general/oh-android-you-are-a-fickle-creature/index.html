<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Oh Android you are a fickle creature.. | Infinitespace Studios</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Oh Android you are a fickle creature.." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So as you may have noticed I’ve been playing about allot with OpenGL and android recently and I started to see some very weird behaviour. The normal activity life cycle states that when the lock screen is enabled, the activity will be Paused, then Stopped. This seemed to be the behaviour I saw in the devices I was testing on until I tried a Nexus 4.. On lock it would Pause, Stop then Destroy.. WFT! and it would only do this on the Nexus 4." />
<meta property="og:description" content="So as you may have noticed I’ve been playing about allot with OpenGL and android recently and I started to see some very weird behaviour. The normal activity life cycle states that when the lock screen is enabled, the activity will be Paused, then Stopped. This seemed to be the behaviour I saw in the devices I was testing on until I tried a Nexus 4.. On lock it would Pause, Stop then Destroy.. WFT! and it would only do this on the Nexus 4." />
<link rel="canonical" href="http://localhost:4000/general/oh-android-you-are-a-fickle-creature/" />
<meta property="og:url" content="http://localhost:4000/general/oh-android-you-are-a-fickle-creature/" />
<meta property="og:site_name" content="Infinitespace Studios" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-06-05T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Oh Android you are a fickle creature.." />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2014-06-05T00:00:00+01:00","datePublished":"2014-06-05T00:00:00+01:00","description":"So as you may have noticed I’ve been playing about allot with OpenGL and android recently and I started to see some very weird behaviour. The normal activity life cycle states that when the lock screen is enabled, the activity will be Paused, then Stopped. This seemed to be the behaviour I saw in the devices I was testing on until I tried a Nexus 4.. On lock it would Pause, Stop then Destroy.. WFT! and it would only do this on the Nexus 4.","headline":"Oh Android you are a fickle creature..","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/general/oh-android-you-are-a-fickle-creature/"},"url":"http://localhost:4000/general/oh-android-you-are-a-fickle-creature/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom head content - add custom meta tags, analytics, etc. here -->

  </head>
  <body>
    <header class="site-header">
      <div class="header-content">
        <a href="/" class="logo-link">
          <img src="/images/issheader.png" alt="Infinitespace Studios" class="site-logo">
          <span class="site-title">Infinitespace Studios</span>
        </a>
        <nav class="main-nav">
          <ul>
            <li><a href="/">Blog</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/monogame-ports">Ports</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="site-content">
      <div class="container">
        <p>So as you may have noticed I’ve been playing about allot with OpenGL and android recently and I started to see some very weird behaviour. The normal <a href="http://developer.xamarin.com/Guides/Android/Application_Fundamentals/Activity_Lifecycle/">activity life cycle</a> states that when the lock screen is enabled, the activity will be Paused, then Stopped. This seemed to be the behaviour I saw in the devices I was testing on until I tried a Nexus 4.. On lock it would Pause, Stop then Destroy.. WFT! and it would only do this on the Nexus 4.</p>

<p>This caused me a big problem because the app I was putting together was a game, so if the screen locked in the middle of a game it wouldn’t just pickup from where it left it would restart the entire app and loose your progress… Not happy.. So I spent ages looking at my code to try to figure out what was going on and I stumbled across the following property when messing about in my OnDestroy method of the Activity.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="n">ChangingConfigurations</span>
</code></pre></div></div>

<p>Hmm, what was that property about. Well it turns out this property tells you which configurations changed. When I looked at this when in my OnDestroy method I was it had a value of ScreenSize… Hmm A bit more research lead me to this from the android docs.</p>

<blockquote>
  <p><strong>Caution:</strong> Beginning with Android 3.2 (API level 13), <strong>the “screen size” also changes</strong> when the device switches between portrait and landscape orientation. Thus, if you want to prevent runtime restarts due to orientation change when developing for API level 13 or higher (as declared by the <a href="http://developer.android.com/guide/topics/manifest/uses-sdk-element.html#min"><code class="language-plaintext highlighter-rouge">minSdkVersion</code></a> and<a href="http://developer.android.com/guide/topics/manifest/uses-sdk-element.html#target"><code class="language-plaintext highlighter-rouge">targetSdkVersion</code></a> attributes), you must include the <code class="language-plaintext highlighter-rouge">"screenSize"</code> value in addition to the<code class="language-plaintext highlighter-rouge">"orientation"</code> value. That is, you must decalare<code class="language-plaintext highlighter-rouge">android:configChanges="orientation|screenSize"</code>. However, if your application targets API level 12 or lower, then your activity always handles this configuration change itself (this configuration change does not restart your activity, even when running on an Android 3.2 or higher device).</p>
</blockquote>

<p>So now it all makes sense.. When the nexus 4 (Andoid 4.3) was screen locking it was changing the Orientation to Portrait (helpful..not) which I was handling, <strong>but</strong> also raising a screen size config change, which I was not.. hence the OS destroying my activity. Normally when you get a new OpenGL based app in Xamarin.Android you get the following attributes added automagically to your activity.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Activity</span> <span class="p">(</span><span class="n">Label</span> <span class="p">=</span> <span class="s">"Some app"</span><span class="p">,</span>
<span class="cp">#if __ANDROID_11__
</span>  <span class="n">HardwareAccelerated</span><span class="p">=</span><span class="k">false</span><span class="p">,</span>
<span class="cp">#endif
</span>  <span class="n">ConfigurationChanges</span> <span class="p">=</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">Orientation</span> <span class="p">|</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">Keyboard</span> <span class="p">|</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">KeyboardHidden</span><span class="p">,</span>
  <span class="n">MainLauncher</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
</code></pre></div></div>

<p>These tell android that you want to handle these changes and not the OS, so the OS doesn’t restart you app when this stuff happens. Because of this change in Android 3.2+ we need to add the ScreenSize enumeration as well like so</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">Activity</span> <span class="p">(</span><span class="n">Label</span> <span class="p">=</span> <span class="s">"Some app"</span><span class="p">,</span>
<span class="cp">#if __ANDROID_11__
</span>  <span class="n">HardwareAccelerated</span><span class="p">=</span><span class="k">false</span><span class="p">,</span>
<span class="cp">#endif
</span>  <span class="n">ConfigurationChanges</span> <span class="p">=</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">Orientation</span> <span class="p">|</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">Keyboard</span> <span class="p">|</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">KeyboardHidden</span> <span class="p">|</span> <span class="n">ConfigChanges</span><span class="p">.</span><span class="n">ScreenSize</span><span class="p">,</span>
  <span class="n">MainLauncher</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
</code></pre></div></div>

<p>Now our app can be paused and resumed as normal when you lock the screen without it restarting. Yay!</p>

      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>&copy; 2009-2026 Infinitespace Studios. All rights reserved.</p>
        <div class="social-links">
          <a href="https://github.com/dellis1972" aria-label="GitHub">GitHub</a>
          <a href="https://mastodon.gamedev.place/@infspacestudios" aria-label="Mastodon">Mastodon</a>
        </div>
      </div>
    </footer>
  </body>
</html>